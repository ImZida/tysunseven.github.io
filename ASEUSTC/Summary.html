<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>筛选文件</title>
    <style>
      li.selected, tr.selected {
        background-color: yellow;
      }
    </style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  </head>
  <body>
    <h1>筛选文件</h1>
    
    <table id="file-list">
      <thead>
        <tr>
          <th><div>
            <select id="year" onchange="filterFiles()">
              <option value="">所有年份</option>
              <option value="2018">2018年</option>
              <option value="2019">2019年</option>
              <option value="2020">2020年</option>
              <option value="2021">2021年</option>
              <option value="2022">2022年</option>
              <option value="2023">2023年</option>
            </select>
          </div></th>

          <th><div>
            <select id="time" onchange="filterFiles()">
              <option value="">所有时间</option>
              <option value="寒假">寒假</option>
              <option value="暑假">暑假</option>
              <option value="五一">五一</option>
              <option value="国庆">国庆</option>
              <option value="清明">清明</option>
              <option value="端午">端午</option>
            </select>
          </div></th>

          <th><div>
            <select id="location" onchange="filterFiles()">
              <option value="">所有地点</option>
              <option value="白际">白际</option>
              <option value="龙井河">龙井河</option>
              <option value="庐江">庐江</option>
              <option value="霄坑">霄坑</option>
              <option value="龙须山">龙须山</option>
              <option value="金寨">金寨</option>
              <option value="九华山">九华山</option>
              <option value="鹞落坪">鹞落坪</option>
              <option value="黔县">黔县</option>
            </select>
          </div></th>

          <th><div>
            <select id="property" onchange="filterFiles()">
              <option value="">所有性质</option>
              <option value="拉练">拉练</option>
              <option value="考察">考察</option>
              <option value="探路">探路</option>
              <option value="干事">干事</option>
              <option value="暑期">暑期</option>
            </select>
          </div>
          </th>
          

          <th><div>
            <select id="duty" onchange="filterFiles()">
              <option value="">所有职责</option>
              <option value="主领">主领</option>
              <option value="财务副领">财务副领</option>
              <option value="装备副领">装备副领</option>
              <option value="行军副领">行军副领</option>
              <option value="考察副领">考察副领</option>
              <option value="考察报告">考察报告</option>
              <option value="大厨">大厨</option>
            </select>
          </div></th>

          <th>选中</th>
        </tr>
      </thead>
      
      <tbody>
        <tr data-year="2019" data-time="清明" data-location="白际"  data-property="拉练" data-duty="主领" data-file="2019-清明-白际-拉练-主领.docx">
          <td>2019</td>
          <td>清明</td>
          <td>白际</td>
          <td>拉练</td>
          <td>主领</td>
          <td><input type="checkbox"></td>
        </tr>

        <tr data-year="2021" data-time="五一" data-location="金寨" data-property="考察" data-duty="主领" data-file="2021-五一-金寨-考察-主领.docx">
          <td>2021</td>
          <td>五一</td>
          <td>金寨</td>
          <td>考察</td>
          <td>主领</td>
          <td><input type="checkbox"></td>
        </tr>
        <tr data-year="2021" data-time="五一" data-location="金寨" data-property="考察" data-duty="装备副领" data-file="2021-五一-金寨-考察-装备副领.docx">
          <td>2021</td>
          <td>五一</td>
          <td>金寨</td>
          <td>考察</td>
          <td>装备副领</td>
          <td><input type="checkbox"></td>
        </tr>
        <tr data-year="2021" data-time="五一" data-location="金寨" data-property="考察" data-duty="财务副领" data-file="2021-五一-金寨-考察-财务副领.docx">
          <td>2021</td>
          <td>五一</td>
          <td>金寨</td>
          <td>考察</td>
          <td>财务副领</td>
          <td><input type="checkbox"></td>
        </tr>

        <tr data-year="2023" data-time="清明" data-location="白际"  data-property="考察" data-duty="财务副领" data-file="2023-清明-白际-考察-财务副领.pdf">
          <td>2023</td>
          <td>清明</td>
          <td>白际</td>
          <td>考察</td>
          <td>财务副领</td>
          <td><input type="checkbox"></td>
        </tr>

        <tr data-year="2021" data-time="五一" data-location="金寨" data-property="考察" data-duty="报告" data-file="2021-五一-金寨-考察-报告.pdf">
          <td>2021</td>
          <td>五一</td>
          <td>金寨</td>
          <td>考察</td>
          <td>报告</td>
          <td><input type="checkbox"></td>
        </tr>
      </tbody>
    </table>
    
    <script>
      function filterFiles() {
        const location = document.getElementById("location").value;
        const time = document.getElementById("time").value;
        const duty = document.getElementById("duty").value;
        
        const files = document.getElementById("file-list").getElementsByTagName("tbody")[0].getElementsByTagName("tr");
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          if ((location === "" || file.getAttribute("data-location") === location) &&
              (time === "" || file.getAttribute("data-time") === time) &&
              (duty === "" || file.getAttribute("data-duty") === duty)) {
            file.style.display = "table-row";
          } else {
            file.style.display = "none";
          }
        }
      }

      function downloadSelected() {
  const files = document.getElementById("file-list").getElementsByTagName("tbody")[0].getElementsByTagName("tr");
  const selectedFiles = [];
  for (let i = 0; i < files.length; i++) {
    const file = files[i];
    if (file.querySelector("input[type='checkbox']").checked) {
      selectedFiles.push(file.getAttribute("data-file"));
    }
  }
  if (selectedFiles.length > 0) {
    const zip = new JSZip();
    const folder = zip.folder("下载文件");
    const promises = [];
    for (let i = 0; i < selectedFiles.length; i++) {
      const file = selectedFiles[i];
      const promise = fetch(encodeURI(file), { responseType: "blob" })
        .then(response => response.blob())
        .then(blob => folder.file(decodeURI(file), blob));
      promises.push(promise);
    }
    Promise.all(promises).then(() => {
      zip.generateAsync({ type: "blob" }).then(content => {
        saveAs(content, "多个文件.zip");
      });
    });
  }
}
    </script>

  <button onclick="downloadSelected()">下载选中文件</button>
</body>
</html>