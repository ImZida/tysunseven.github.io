<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>筛选文件</title>
    <style>
      li.selected, tr.selected {
        background-color: yellow;
      }
    </style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  </head>
  <body>
    <h1>筛选文件</h1>
    
    <table id="file-list">
      <thead>
        <tr>
          <th><div>
            <select id="location" onchange="filterFiles()">
              <option value="">所有地点</option>
              <option value="白际">白际</option>
              <option value="龙井河">龙井河</option>
            </select>
          </div></th>

          <th><div>
            <select id="time" onchange="filterFiles()">
              <option value="">所有时间</option>
              <option value="2015">2019年</option>
              <option value="2018">2023年</option>
            </select>
          </div></th>

          <th><div>
            <select id="duty" onchange="filterFiles()">
              <option value="">所有职责</option>
              <option value="主领">主领</option>
              <option value="财务副领">财务副领</option>
            </select>
          </div></th>

          <th>选中</th>
        </tr>
      </thead>
      
      <tbody>
        <tr data-location="白际" data-time="2019" data-duty="主领" data-file="2019-清明-白际-拉练-主领.docx">
          <td>白际</td>
          <td>2019年</td>
          <td>主领</td>
          <td><input type="checkbox"></td>
        </tr>
        <tr data-location="白际" data-time="2023" data-duty="财务副领" data-file="2023-清明-白际-考察-财务副领.pdf">
          <td>白际</td>
          <td>2023年</td>
          <td>财务副领</td>
          <td><input type="checkbox"></td>
        </tr>
      </tbody>
    </table>
    
    <script>
      function filterFiles() {
        const location = document.getElementById("location").value;
        const time = document.getElementById("time").value;
        const duty = document.getElementById("duty").value;
        
        const files = document.getElementById("file-list").getElementsByTagName("tbody")[0].getElementsByTagName("tr");
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          if ((location === "" || file.getAttribute("data-location") === location) &&
              (time === "" || file.getAttribute("data-time") === time) &&
              (duty === "" || file.getAttribute("data-duty") === duty)) {
            file.style.display = "table-row";
          } else {
            file.style.display = "none";
          }
        }
      }

      function downloadSelected() {
  const files = document.getElementById("file-list").getElementsByTagName("tbody")[0].getElementsByTagName("tr");
  const selectedFiles = [];
  for (let i = 0; i < files.length; i++) {
    const file = files[i];
    if (file.querySelector("input[type='checkbox']").checked) {
      selectedFiles.push(file.getAttribute("data-file"));
    }
  }
  if (selectedFiles.length > 0) {
    const zip = new JSZip();
    const folder = zip.folder("下载文件");
    const promises = [];
    for (let i = 0; i < selectedFiles.length; i++) {
      const file = selectedFiles[i];
      const promise = fetch(encodeURI(file), { responseType: "blob" })
        .then(response => response.blob())
        .then(blob => folder.file(decodeURI(file), blob));
      promises.push(promise);
    }
    Promise.all(promises).then(() => {
      zip.generateAsync({ type: "blob" }).then(content => {
        saveAs(content, "多个文件.zip");
      });
    });
  }
}
    </script>

  <button onclick="downloadSelected()">下载选中文件</button>
</body>
</html>